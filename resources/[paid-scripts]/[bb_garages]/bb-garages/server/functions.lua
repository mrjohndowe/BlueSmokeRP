serverConfig = GaragesConfig
serverConfig['garages'] = json.decode(LoadResourceFile(GetCurrentResourceName(), 'database\\garages.json'))
serverConfig['impounds'] = json.decode(LoadResourceFile(GetCurrentResourceName(), 'database\\impounds.json'))
RegisterServerEvent('bb-garages:server:dev:creategarage')AddEventHandler('bb-garages:server:dev:creategarage',function(a,b,c)local d=source;local e=c[1]if serverConfig['garages'][e]==nil then local f={}f['blip']={['enable']=true,['coords']=a,['type']='garage'}f['slots']={}f['payment']={['price']=36,['onetime']=false}local g=json.decode(LoadResourceFile(GetCurrentResourceName(),'database\\garages.json'))g[e]=f;local h=SaveResourceFile(GetCurrentResourceName(),'database\\garages.json',json.encode(g),-1)serverConfig['garages'][e]=f;TriggerClientEvent(CorePrefix..':Notify',d,"Created new garage! ["..e.."]","success")TriggerClientEvent('bb-garages:client:syncConfig',-1,1,serverConfig)else TriggerClientEvent(CorePrefix..':Notify',d,"A Garage with the same name already exists","error")end end)RegisterServerEvent('bb-garages:server:dev:setinteract')AddEventHandler('bb-garages:server:dev:setinteract',function(a,b,c)local d=source;local i=tonumber(c[1])~=nil and tonumber(c[1])==1 and true or false;local j=GetClosestGarage(a)if j~=''then local k={['coords']=a,['created']=false,['heading']=b,['type']=-567724045,['enable']=i}local g=json.decode(LoadResourceFile(GetCurrentResourceName(),'database\\garages.json'))if g[j]~=nil then g[j]['ped']=k;local h=SaveResourceFile(GetCurrentResourceName(),'database\\garages.json',json.encode(g),-1)serverConfig['garages'][j]['ped']=k;TriggerClientEvent(CorePrefix..':Notify',d,"Updated "..j.." interact location.","success")TriggerClientEvent('bb-garages:client:syncConfig',-1,1,serverConfig)else TriggerClientEvent(CorePrefix..':Notify',d,"Error: Could not find the garage "..j.." on the Database","error")end else TriggerClientEvent(CorePrefix..':Notify',d,"Error: Could not find closest garage.","error")end end)RegisterServerEvent('bb-garages:server:dev:setpayment')AddEventHandler('bb-garages:server:dev:setpayment',function(a,b,c)local d=source;local l=tonumber(c[1])local m=c[2]local j=GetClosestGarage(a)if j~=''then local n={['price']=l,['onetime']=m}local g=json.decode(LoadResourceFile(GetCurrentResourceName(),'database\\garages.json'))if g[j]~=nil then g[j]['payment']=n;local h=SaveResourceFile(GetCurrentResourceName(),'database\\garages.json',json.encode(g),-1)serverConfig['garages'][j]['payment']=n;TriggerClientEvent(CorePrefix..':Notify',d,"Updated "..j.." payment information.","success")TriggerClientEvent('bb-garages:client:syncConfig',-1,1,serverConfig)else TriggerClientEvent(CorePrefix..':Notify',d,"Error: Could not find the garage "..j.." on the Database","error")end else TriggerClientEvent(CorePrefix..':Notify',d,"Error: Could not find closest garage.","error")end end)RegisterServerEvent('bb-garages:server:dev:saveCoords')AddEventHandler('bb-garages:server:dev:saveCoords',function(e,o)local d=source;local g=json.decode(LoadResourceFile(GetCurrentResourceName(),'database\\garages.json'))if g[e]~=nil then local p=g[e]['slots']local q={}for r,s in pairs(p)do q[#q+1]={{x=s[1].x,y=s[1].y,z=s[1].z,h=s[1].h},true}end;for r,s in pairs(o)do q[#q+1]={{x=s[1].x,y=s[1].y,z=s[1].z,h=s[2]},true}serverConfig['garages'][e]['slots'][r]={{x=s[1].x,y=s[1].y,z=s[1].z,h=s[2]},true}end;g[e]['slotsbackup']=g[e]['slots']g[e]['slots']=q;SaveResourceFile(GetCurrentResourceName(),'database\\garages.json',json.encode(g),-1)TriggerClientEvent('bb-garages:client:syncConfig',-1,1,serverConfig)end end)

function addons(t, data, vehicle)
    serverConfig['garages'][data[2]]['slots'][data[1]][2] = false
    serverConfig['garages'][data[2]]['slots'][data[1]][3] = {model = vehicle.model, props = json.decode(vehicle.props), plate = vehicle.plate}
end